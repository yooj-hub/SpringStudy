# 값 타입

---



- 기본값 타입
- 임베디드 타입
- 값 타입과 불변 객체
- 값 타입의 비교
- 값 타입 컬렉션



---





## 기본값 타입

- 엔티티 타입
  - @Entity로 정의하는 객체
  - 데이터가 변해도 식별자로 지속해서 추적 가능



- 값 타입
  - int Integer String 처럼 단순히 값으로 사용하는 자바 기본 타입이나 객체 식별자가 없고 값만 있으므로 변경시 추적 불가





### 값 타입

- 기본 값 타입
  - 자바 기본 타입(다른 값과 절대 공유되지 않음)
  - 래퍼 클래스
  - String
- 임베디드 타입(embedded type, 복핪 값 타입)
- 컬렉션 값 타입
- 생명 주기를 엔티티에 의존
- 값 타입은 공유하면 안된다.



---





## 임베디드 타입



- 기본 생성자 필수
- 재사용 가능
- 높은 응집도
- 의미있는 메소드를 만들 수 잇음
- 임베디드 타입을 포함한 모든 값 타입은, 값 타입을 소유한 엔티티에 생명주기를 으존함
- 같은 임베디드 타입을 사용할 경우 @AttributeOverrides를 사용하여 @AttrivuteOveride를 통하여 column을 바꿔야한다. 한다.





---



## 값 타입과 불변 객체



- 임베디드타입 같은 객체를 공유할 때, 다른 엔티티에서 변경하게되면 같이 값이 변경되게 된다.
- 같은 객체를 공유할때 복사하여 이용한다.(=이 아닌 각 인스턴스의 값을 복사하여 새로운 객체를 사용하여 이용)
- setter를 private나, 아예 막는 형식으로 만드는게 좋다. 단 변경시 새로 만들어 이용한다.



### 값 타입의 비교

- 인스턴스가 다랄도, 그 안에 값이 같으면 같은 것으로 봐야함.
- 동일성 비교
  - 인스턴스의 참조 값을 비교, == 사용
- 동승성 비교
  - 인스턴스의 값을 비교, equals()
- 값 타입은 equals
  - equals 사용 또는 equals 메소드를 재정의





---





## 값 타입 컬렉션



- 값타입은 컬렉션은 영속성 전에(Cascade)+ 고아 객체 제거 기능을 필수로 가진다고 볼 수 있다.
- 값 타입 컬렉션은 지연로딩 전략을 기본으로 사용한다.
- 값 타입은 엔티티와 다르게 식별자 개념이 없다.
- 값이 변경되면 추적이 어렵다.
- 값 타입 컬렉션에 변경사항이 발생하면 주인 엔티티와 관련된 컬렉션을 지우고 다시 저장한다.
  - 이를 시행하면 다수의 쿼리가 나가 성능저하가 발생할 수 있다.
  - 이를 보완하기위해 컬렉션 대신에 일대다 관계를 이용한다.

















